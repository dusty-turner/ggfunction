<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Extending ggplot2 with functional capabilities ‚Ä¢ ggfunction</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Extending ggplot2 with functional capabilities">
<meta name="description" content="A ggplot2 extension for visualizing functions in a two-dimensional space.">
<meta property="og:description" content="A ggplot2 extension for visualizing functions in a two-dimensional space.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ggfunction</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/ggfunction.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/dusty-turner/ggfunction/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="ggfunction">ggfunction<a class="anchor" aria-label="anchor" href="#ggfunction"></a>
</h1></div>
<!-- README.md is generated from README.Rmd. Please edit that file -->
<!-- badges: start -->

<p><strong>ggfunction</strong> extends <a href="https://ggplot2.tidyverse.org/"><strong>ggplot2</strong></a> with geoms and stats for plotting mathematical functions and probability distributions directly from function objects. Supply a function and a domain; <strong>ggfunction</strong> handles evaluation, rendering, and shading.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The package is organized around two families of geoms:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr>
<th>Family</th>
<th>Geom</th>
<th>Maps</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td><strong>Dimensional</strong></td>
<td><code><a href="reference/geom_function_1d_1d.html">geom_function_1d_1d()</a></code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>‚Ñù</mi><mo>‚Üí</mo><mi>‚Ñù</mi></mrow><annotation encoding="application/x-tex">\mathbb{R} \to \mathbb{R}</annotation></semantics></math></td>
<td>Scalar functions with optional interval shading</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_function_1d_2d.html">geom_function_1d_2d()</a></code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>‚Ñù</mi><mo>‚Üí</mo><msup><mi>‚Ñù</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathbb{R} \to \mathbb{R}^2</annotation></semantics></math></td>
<td>Parametric curves</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_function_2d_1d.html">geom_function_2d_1d()</a></code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>‚Ñù</mi><mn>2</mn></msup><mo>‚Üí</mo><mi>‚Ñù</mi></mrow><annotation encoding="application/x-tex">\mathbb{R}^2 \to \mathbb{R}</annotation></semantics></math></td>
<td>Scalar fields (raster, contour, filled contour)</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_function_2d_2d.html">geom_function_2d_2d()</a></code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>‚Ñù</mi><mn>2</mn></msup><mo>‚Üí</mo><msup><mi>‚Ñù</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^2 \to \mathbb{R}^2</annotation></semantics></math></td>
<td>Vector field streamlines</td>
</tr>
<tr>
<td><strong>Probability</strong></td>
<td><code><a href="reference/geom_pdf.html">geom_pdf()</a></code></td>
<td></td>
<td>Probability density function</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_pmf.html">geom_pmf()</a></code></td>
<td></td>
<td>Probability mass function (lollipop)</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_cdf.html">geom_cdf()</a></code></td>
<td></td>
<td>Cumulative distribution function</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_cdf_discrete.html">geom_cdf_discrete()</a></code></td>
<td></td>
<td>Discrete CDF (step function)</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_survival.html">geom_survival()</a></code></td>
<td></td>
<td>Survival function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>‚àí</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(x) = 1 - F(x)</annotation></semantics></math>
</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_survival_discrete.html">geom_survival_discrete()</a></code></td>
<td></td>
<td>Discrete survival function (step function)</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_qf.html">geom_qf()</a></code></td>
<td></td>
<td>Quantile function</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_qf_discrete.html">geom_qf_discrete()</a></code></td>
<td></td>
<td>Discrete quantile function (step function)</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_hf.html">geom_hf()</a></code></td>
<td></td>
<td>Hazard function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(x) = f(x)/S(x)</annotation></semantics></math>
</td>
</tr>
<tr>
<td><strong>Data</strong></td>
<td><code><a href="reference/geom_ecdf.html">geom_ecdf()</a></code></td>
<td></td>
<td>Empirical CDF with KS confidence ribbon</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_eqf.html">geom_eqf()</a></code></td>
<td></td>
<td>Empirical quantile function with confidence ribbon</td>
</tr>
<tr>
<td></td>
<td><code><a href="reference/geom_epmf.html">geom_epmf()</a></code></td>
<td></td>
<td>Empirical PMF (lollipop)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="dimensional-taxonomy">Dimensional Taxonomy<a class="anchor" aria-label="anchor" href="#dimensional-taxonomy"></a>
</h2>
<div class="section level3">
<h3 id="scalar-functions-geom_function_1d_1d">Scalar functions: <code>geom_function_1d_1d()</code>
<a class="anchor" aria-label="anchor" href="#scalar-functions-geom_function_1d_1d"></a>
</h3>
<p><code><a href="reference/geom_function_1d_1d.html">geom_function_1d_1d()</a></code> evaluates a function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>:</mo><mi>‚Ñù</mi><mo>‚Üí</mo><mi>‚Ñù</mi></mrow><annotation encoding="application/x-tex">f\colon \mathbb{R} \to \mathbb{R}</annotation></semantics></math> at <code>n</code> equally-spaced points over <code>xlim</code> and draws it as a curve, extending <code><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">ggplot2::stat_function()</a></code> with built-in region shading. The following example plots the sine function over one full period.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dusty-turner/ggfunction">"ggfunction"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_function_1d_1d.html">geom_function_1d_1d</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">sin</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-1d-1d-1.png" width="60%"></p>
<p><strong>Shading intervals.</strong> The <code>shade_from</code> and <code>shade_to</code> parameters fill the region between the curve and the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-axis over a specified interval. Here we shade the standard normal density between <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>‚àí</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>, corresponding to approximately 68% of the total area.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_function_1d_1d.html">geom_function_1d_1d</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">sin</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, shade_from <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, shade_to <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-1d-1d-shade-1.png" width="60%"></p>
</div>
<div class="section level3">
<h3 id="parametric-curves-geom_function_1d_2d">Parametric curves: <code>geom_function_1d_2d()</code>
<a class="anchor" aria-label="anchor" href="#parametric-curves-geom_function_1d_2d"></a>
</h3>
<p><code><a href="reference/geom_function_1d_2d.html">geom_function_1d_2d()</a></code> evaluates a parametric curve <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùõÑ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\gamma}(t) = (x(t),\, y(t))</annotation></semantics></math> over the range <code>tlim</code> with step size <code>dt</code>, coloring the path by the time parameter by default. The following example traces the lemniscate of Bernoulli ‚Äì a figure-eight curve along which the product of distances to the two foci is constant ‚Äì <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùõÑ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mo>cos</mo><mi>t</mi><mspace width="0.167em"></mspace><mi>/</mi><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mo>sin</mo><mn>2</mn></msup><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.278em"></mspace><mo>sin</mo><mi>t</mi><mo>cos</mo><mi>t</mi><mspace width="0.167em"></mspace><mi>/</mi><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mo>sin</mo><mn>2</mn></msup><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{\gamma}(t) = \bigl(\cos t\,/\,(1 + \sin^2 t),\; \sin t\cos t\,/\,(1 + \sin^2 t)\bigr)</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lemniscate</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_function_1d_2d.html">geom_function_1d_2d</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">lemniscate</span>, tlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.9</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-1d-2d-1.png" width="60%"></p>
<p><strong>Arrowheads and tail points.</strong> Setting <code>tail_point = TRUE</code> and passing <code><a href="https://rdrr.io/r/grid/arrow.html">grid::arrow()</a></code> to <code>arrow</code> marks the starting position of the curve with a point and the tail with an arrowhead, respectively, useful for showing an initial condition and direction of the curve.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_function_1d_2d.html">geom_function_1d_2d</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">lemniscate</span>, tlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.9</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span>, tail_point <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="st">"npc"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"closed"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-1d-2d-arrows-and-tail-1.png" width="60%"></p>
<p><strong>Parameterized families.</strong> Extra parameters for <code>fun</code> are passed via <code>args</code>. The following example traces a Lissajous figure, a closed curve that results when two sinusoids with a rational frequency ratio are combined.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lissajous</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">a</span> <span class="op">=</span> <span class="fl">3</span>, <span class="va">b</span> <span class="op">=</span> <span class="fl">2</span>, <span class="va">delta</span> <span class="op">=</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">t</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">b</span> <span class="op">*</span> <span class="va">t</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_function_1d_2d.html">geom_function_1d_2d</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">lissajous</span>, tlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.9</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span>,</span>
<span>    args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">3</span>, b <span class="op">=</span> <span class="fl">2</span>, delta <span class="op">=</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-1d-2d-lissajous-1.png" width="60%"></p>
</div>
<div class="section level3">
<h3 id="scalar-fields-geom_function_2d_1d">Scalar fields: <code>geom_function_2d_1d()</code>
<a class="anchor" aria-label="anchor" href="#scalar-fields-geom_function_2d_1d"></a>
</h3>
<p><code><a href="reference/geom_function_2d_1d.html">geom_function_2d_1d()</a></code> evaluates a scalar field <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>:</mo><msup><mi>‚Ñù</mi><mn>2</mn></msup><mo>‚Üí</mo><mi>‚Ñù</mi></mrow><annotation encoding="application/x-tex">f\colon \mathbb{R}^2 \to \mathbb{R}</annotation></semantics></math> on an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>√ó</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math> grid over <code>xlim</code> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>√ó</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math><code>ylim</code>. The function must accept a numeric vector of length 2 and return a scalar; extracting components with <code>x &lt;- v[1]; y &lt;- v[2]</code> is the recommended pattern. The example below shows a Gaussian bump <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mspace width="-0.167em"></mspace><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(x,y) = \exp\!\bigl(-(x^2+y^2)/2\bigr)</annotation></semantics></math> rendered as a raster heatmap (the default <code>type</code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_function_2d_1d.html">geom_function_2d_1d</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-2d-1d-raster-1.png" width="60%"></p>
<p><strong>Contour modes.</strong> The <code>type</code> argument switches among three visual encodings of the same field. <code>"contour"</code> draws iso-level curves colored by level value; <code>"contour_filled"</code> draws filled regions between levels; both respond to <code>bins</code>, <code>binwidth</code>, and <code>breaks</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_function_2d_1d.html">geom_function_2d_1d</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"contour"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-2d-1d-contour-1.png" width="60%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_function_2d_1d.html">geom_function_2d_1d</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"contour_filled"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-2d-1d-filled-1.png" width="60%"></p>
</div>
<div class="section level3">
<h3 id="vector-fields-geom_function_2d_2d">Vector fields: <code>geom_function_2d_2d()</code>
<a class="anchor" aria-label="anchor" href="#vector-fields-geom_function_2d_2d"></a>
</h3>
<p><code><a href="reference/geom_function_2d_2d.html">geom_function_2d_2d()</a></code> visualizes a vector field <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêÖ</mi><mo>:</mo><msup><mi>‚Ñù</mi><mn>2</mn></msup><mo>‚Üí</mo><msup><mi>‚Ñù</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathbf{F}\colon \mathbb{R}^2 \to \mathbb{R}^2</annotation></semantics></math> via <a href="https://github.com/dusty-turner/ggvfields"><strong>ggvfields</strong></a>. The function should accept a length-2 vector and return a length-2 vector. By default (<code>type = "vector"</code>) it draws short arrows at each grid point colored by field magnitude; <code>type = "stream"</code> switches to integral-curve streamlines. The following example shows the rotation field <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêÖ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mi>y</mi><mo>,</mo><mspace width="0.167em"></mspace><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{F}(x,y) = (-y,\, x)</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">u</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">u</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_function_2d_2d.html">geom_function_2d_2d</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-2d-2d-1.png" width="60%"></p>
<p><strong>Stream field.</strong> Setting <code>type = "stream"</code> renders the field as integral curves computed by numerical integration, colored by average speed along each curve.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_function_2d_2d.html">geom_function_2d_2d</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"stream"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-2d-2d-stream-1.png" width="60%"></p>
</div>
</div>
<div class="section level2">
<h2 id="probability-distributions">Probability Distributions<a class="anchor" aria-label="anchor" href="#probability-distributions"></a>
</h2>
<p>The probability family provides a geom for each of the standard functions associated with a distribution. Each accepts a plain R function (e.g.¬†<code>dnorm</code>, <code>pnorm</code>) and <code>xlim</code>; distribution parameters are passed via <code>args</code>.</p>
<div class="section level3">
<h3 id="pdf-geom_pdf">PDF: <code>geom_pdf()</code>
<a class="anchor" aria-label="anchor" href="#pdf-geom_pdf"></a>
</h3>
<p><code><a href="reference/geom_pdf.html">geom_pdf()</a></code> draws a probability density function as a filled area. It validates that the supplied function integrates to 1 over <code>xlim</code>, warning via <a href="https://cli.r-lib.org/"><strong>cli</strong></a> if it does not. The basic call draws the full density with no shading.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_pdf.html">geom_pdf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-geom-pdf-1.png" width="60%"></p>
<p><strong>Single threshold.</strong> The <code>p</code> parameter shades from the left boundary up to the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-quantile (<code>lower.tail = TRUE</code>, the default). Setting <code>lower.tail = FALSE</code> shades the upper tail instead. Here we shade the lower 97.5%.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_pdf.html">geom_pdf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-geom-pdf-p-1.png" width="60%"></p>
<p><strong>Two-sided interval.</strong> <code>p_lower</code> and <code>p_upper</code> together shade the central region between two quantiles‚Äîthe natural picture for a confidence interval. The following example shades the central 95%.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_pdf.html">geom_pdf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, p_lower <span class="op">=</span> <span class="fl">0.025</span>, p_upper <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-pdf-twosided-1.png" width="60%"></p>
<p><strong>Tail shading.</strong> Setting <code>shade_outside = TRUE</code> inverts the two-sided region, shading both tails. This is the rejection region of a two-sided hypothesis test at level <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_pdf.html">geom_pdf</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">dnorm</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    p_lower <span class="op">=</span> <span class="fl">0.025</span>, p_upper <span class="op">=</span> <span class="fl">0.975</span>, shade_outside <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-pdf-tails-1.png" width="60%"></p>
<p><strong>Highest density region.</strong> <code>shade_hdr</code> shades the smallest region of the domain containing the specified probability mass‚Äîthe <a href="https://en.wikipedia.org/wiki/Credible_interval#Highest_density_interval">highest density region</a> (HDR). For multimodal densities this region can be disconnected. The following example uses an asymmetric mixture of two normals; the 80% HDR captures both modes as two disjoint intervals, with more area allocated to the taller, narrower component.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_mix</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_pdf.html">geom_pdf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f_mix</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, shade_hdr <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-pdf-hdr-1.png" width="60%"></p>
</div>
<div class="section level3">
<h3 id="pmf-geom_pmf">PMF: <code>geom_pmf()</code>
<a class="anchor" aria-label="anchor" href="#pmf-geom_pmf"></a>
</h3>
<p><code><a href="reference/geom_pmf.html">geom_pmf()</a></code> evaluates a probability mass function at each integer in <code>xlim</code> and renders the result as a lollipop chart‚Äîvertical segments capped with points. Distribution parameters are supplied via <code>args</code>. The following example plots a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Binomial</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>10</mn><mo>,</mo><mn>0.3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Binomial}(10, 0.3)</annotation></semantics></math> distribution.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_pmf.html">geom_pmf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-geom-pmf-1.png" width="60%"></p>
<p><strong>Single threshold.</strong> The <code>p</code> parameter shades lollipops up to the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-quantile (grey dashed sticks mark the unshaded region). Here we shade the lower 80% of a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Binomial</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>10</mn><mo>,</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Binomial}(10, 0.5)</annotation></semantics></math> distribution.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_pmf.html">geom_pmf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-geom-pmf-p-1.png" width="60%"></p>
<p><strong>Highest density region.</strong> <code>shade_hdr</code> shades the smallest set of support points whose total probability mass meets or exceeds the target coverage. For a symmetric unimodal PMF this is a central interval; for a skewed distribution it is asymmetric. Here the 70% HDR of a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Binomial</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>10</mn><mo>,</mo><mn>0.3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Binomial}(10, 0.3)</annotation></semantics></math> distribution is highlighted.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_pmf.html">geom_pmf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>    shade_hdr <span class="op">=</span> <span class="fl">.70</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-geom-pmf-hdr-1.png" width="60%"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_pmf.html">geom_pmf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>    shade_hdr <span class="op">=</span> <span class="fl">.80</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-geom-pmf-hdr-2-1.png" width="60%"></p>
<p><strong>Explicit support.</strong> When the support is not a sequence of consecutive integers, pass the exact support points via <code>support</code>. Here we plot the distribution of the sample mean <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>X</mi><mo accent="true">‚Äæ</mo></mover><annotation encoding="application/x-tex">\bar X</annotation></semantics></math> of 10 iid <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Bernoulli}(0.3)</annotation></semantics></math> draws. The support is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>0.1</mn><mo>,</mo><mn>0.2</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{0, 0.1, 0.2, \ldots, 1\}</annotation></semantics></math> and the PMF is binomial: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>X</mi><mo accent="true">‚Äæ</mo></mover><mo>=</mo><mi>k</mi><mi>/</mi><mn>10</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mn>10</mn><mi>k</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msup><mn>0.3</mn><mi>k</mi></msup><msup><mn>0.7</mn><mrow><mn>10</mn><mo>‚àí</mo><mi>k</mi></mrow></msup></mrow><annotation encoding="application/x-tex">P(\bar X = k/10) = \binom{10}{k}0.3^k 0.7^{10-k}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">prob</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="va">prob</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_pmf.html">geom_pmf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f_mean</span>, support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-geom-pmf-support-1.png" width="60%"></p>
</div>
<div class="section level3">
<h3 id="cdf-geom_cdf-and-geom_cdf_discrete">CDF: <code>geom_cdf()</code> and <code>geom_cdf_discrete()</code>
<a class="anchor" aria-label="anchor" href="#cdf-geom_cdf-and-geom_cdf_discrete"></a>
</h3>
<p>The cumulative distribution function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>‚â§</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(x) = P(X \le x)</annotation></semantics></math> is available for both continuous and discrete distributions.</p>
<p><strong>Continuous (<code><a href="reference/geom_cdf.html">geom_cdf()</a></code>).</strong> Draws the CDF as a line. Here we plot the standard normal CDF.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_cdf.html">geom_cdf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">pnorm</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-geom-cdf-1.png" width="60%"></p>
<p><strong>Discrete (<code><a href="reference/geom_cdf_discrete.html">geom_cdf_discrete()</a></code>).</strong> Takes a PMF, accumulates it into the right-continuous step-function CDF, and renders it with horizontal segments, dashed vertical jumps, open circles at the lower limit of each jump, and closed circles at the achieved value. The following example plots the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Binomial</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>10</mn><mo>,</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Binomial}(10, 0.5)</annotation></semantics></math> CDF.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_cdf_discrete.html">geom_cdf_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-cdf-1.png" width="60%"></p>
<p><strong>Parameterized families.</strong> Here we plot a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Poisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Poisson}(5)</annotation></semantics></math> discrete CDF.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_cdf_discrete.html">geom_cdf_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dpois</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-cdf-pois-1.png" width="60%"></p>
<p><strong>Hiding points and lines.</strong> <code>show_points = FALSE</code> and <code>show_vert = FALSE</code> remove the endpoint circles and vertical jump segments, leaving only the horizontal staircase.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_cdf_discrete.html">geom_cdf_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    show_points <span class="op">=</span> <span class="cn">FALSE</span>, show_vert <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-cdf-no-points-lines-1.png" width="60%"></p>
<p><strong>Explicit support.</strong> Pass non-integer support points directly via <code>support</code>. Here we plot the CDF of the sample mean of 10 iid <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Bernoulli}(0.3)</annotation></semantics></math> draws.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">prob</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="va">prob</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_cdf_discrete.html">geom_cdf_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f_mean</span>, support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-cdf-support-1.png" width="60%"></p>
</div>
<div class="section level3">
<h3 id="survival-function-geom_survival-and-geom_survival_discrete">Survival function: <code>geom_survival()</code> and <code>geom_survival_discrete()</code>
<a class="anchor" aria-label="anchor" href="#survival-function-geom_survival-and-geom_survival_discrete"></a>
</h3>
<p>The survival function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>‚àí</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>&gt;</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(x) = 1 - F(x) = P(X &gt; x)</annotation></semantics></math> gives the probability of surviving past <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.</p>
<p><strong>Continuous (<code><a href="reference/geom_survival.html">geom_survival()</a></code>).</strong> Accepts a CDF via <code>fun</code>. The following example shows the survival function of an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Exponential</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Exponential}(0.5)</annotation></semantics></math> distribution, which decays as <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mi>‚àí</mi><mn>0.5</mn><mi>x</mi></mrow></msup></mrow><annotation encoding="application/x-tex">S(x) = e^{-0.5x}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_survival.html">geom_survival</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">pexp</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-survival-1.png" width="60%"></p>
<p><strong>Discrete (<code><a href="reference/geom_survival_discrete.html">geom_survival_discrete()</a></code>).</strong> Takes a PMF and renders <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>‚àí</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(x) = 1 - F(x)</annotation></semantics></math> as a right-continuous step function using the same visual conventions as <code><a href="reference/geom_cdf_discrete.html">geom_cdf_discrete()</a></code>. The following example plots the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Binomial</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>10</mn><mo>,</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Binomial}(10, 0.5)</annotation></semantics></math> survival function.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_survival_discrete.html">geom_survival_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-survival-1.png" width="60%"></p>
<p><strong>Hiding points.</strong> Setting <code>show_points = FALSE</code> removes the endpoint circles.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_survival_discrete.html">geom_survival_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    show_points <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-survival-no-points-1.png" width="60%"></p>
<p><strong>Explicit support.</strong> The survival function of the sample mean of 10 iid <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Bernoulli}(0.3)</annotation></semantics></math> draws.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">prob</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="va">prob</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_survival_discrete.html">geom_survival_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f_mean</span>, support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-survival-support-1.png" width="60%"></p>
</div>
<div class="section level3">
<h3 id="quantile-function-geom_qf-and-geom_qf_discrete">Quantile function: <code>geom_qf()</code> and <code>geom_qf_discrete()</code>
<a class="anchor" aria-label="anchor" href="#quantile-function-geom_qf-and-geom_qf_discrete"></a>
</h3>
<p>The quantile function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>inf</mo><mo stretchy="false" form="prefix">{</mo><mi>x</mi><mo>:</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚â•</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">Q(p) = \inf\{x : F(x) \ge p\}</annotation></semantics></math> inverts the CDF.</p>
<p><strong>Continuous (<code><a href="reference/geom_qf.html">geom_qf()</a></code>).</strong> Evaluates a quantile function over the unit interval <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0, 1)</annotation></semantics></math> and draws it as a curve. The following example plots the standard normal quantile function.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_qf.html">geom_qf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">qnorm</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-geom-qf-1.png" width="60%"></p>
<p><strong>Discrete (<code><a href="reference/geom_qf_discrete.html">geom_qf_discrete()</a></code>).</strong> Takes a PMF and renders the quantile function as a left-continuous step function on the unit interval, with closed circles at the bottom of each jump (the value is achieved) and open circles at the top (the next value is not yet reached). The following example plots the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Binomial</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>10</mn><mo>,</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Binomial}(10, 0.5)</annotation></semantics></math> quantile function.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_qf_discrete.html">geom_qf_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-qf-1.png" width="60%"></p>
<p><strong>Parameterized families.</strong> Here we plot a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Poisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Poisson}(5)</annotation></semantics></math> discrete quantile function.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_qf_discrete.html">geom_qf_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dpois</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-qf-pois-1.png" width="60%"></p>
<p><strong>Hiding points.</strong> Setting <code>show_points = FALSE</code> removes the endpoint circles, leaving only the horizontal and vertical lines.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_qf_discrete.html">geom_qf_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    show_points <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-qf-no-points-1.png" width="60%"></p>
<p><strong>Hiding vertical lines.</strong> Setting <code>show_vert = FALSE</code> removes the dashed vertical jump segments, leaving only the horizontal steps and endpoint circles.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_qf_discrete.html">geom_qf_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dbinom</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    show_vert <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-qf-no-vert-1.png" width="60%"></p>
<p><strong>Explicit support.</strong> The quantile function of the sample mean of 10 iid <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Bernoulli}(0.3)</annotation></semantics></math> draws.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">prob</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="va">prob</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_qf_discrete.html">geom_qf_discrete</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f_mean</span>, support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-discrete-qf-support-1.png" width="60%"></p>
</div>
<div class="section level3">
<h3 id="hazard-function-geom_hf">Hazard function: <code>geom_hf()</code>
<a class="anchor" aria-label="anchor" href="#hazard-function-geom_hf"></a>
</h3>
<p><code><a href="reference/geom_hf.html">geom_hf()</a></code> plots the hazard function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(x) = f(x) / S(x)</annotation></semantics></math>, the instantaneous rate of failure at time <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> conditional on survival to that point. It requires both a PDF (<code>pdf_fun</code>) and a CDF (<code>cdf_fun</code>). Shared parameters go in <code>args</code>; use <code>pdf_args</code> and <code>cdf_args</code> for overrides when the two functions have different parameterizations. The exponential distribution‚Äôs constant hazard confirms the memoryless property.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_hf.html">geom_hf</a></span><span class="op">(</span>pdf_fun <span class="op">=</span> <span class="va">dexp</span>, cdf_fun <span class="op">=</span> <span class="va">pexp</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">10</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-hazard-1.png" width="60%"></p>
</div>
</div>
<div class="section level2">
<h2 id="data-functions">Data Functions<a class="anchor" aria-label="anchor" href="#data-functions"></a>
</h2>
<p>The data family works with an observed numeric sample rather than a function object. Supply a vector of data via <code>aes(x = ...)</code> and the geom handles the rest. All three geoms use the same visual language as their theoretical counterparts in the Probability section.</p>
<div class="section level3">
<h3 id="empirical-cdf-geom_ecdf">Empirical CDF: <code>geom_ecdf()</code>
<a class="anchor" aria-label="anchor" href="#empirical-cdf-geom_ecdf"></a>
</h3>
<p><code><a href="reference/geom_ecdf.html">geom_ecdf()</a></code> plots the empirical cumulative distribution function of a sample as a right-continuous step function, using the same visual conventions as <code><a href="reference/geom_cdf_discrete.html">geom_cdf_discrete()</a></code>. A 95% simultaneous Kolmogorov-Smirnov confidence ribbon is drawn by default; set <code>conf_int = FALSE</code> to suppress it.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_single</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_ecdf.html">geom_ecdf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-ecdf-1.png" width="60%"></p>
<p><strong>Multiple groups.</strong> Map <code>colour</code> to a grouping variable to overlay ECDFs for several groups. Each group gets its own confidence ribbon, computed from that group‚Äôs sample size.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_two</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_ecdf.html">geom_ecdf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-ecdf-grouped-1.png" width="60%"></p>
<p><strong>Controlling the band.</strong> Use <code>level</code> to change the confidence level and <code>conf_alpha</code> to adjust ribbon transparency.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_single</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_ecdf.html">geom_ecdf</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.99</span>, conf_alpha <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-ecdf-level-1.png" width="60%"></p>
</div>
<div class="section level3">
<h3 id="empirical-quantile-function-geom_eqf">Empirical quantile function: <code>geom_eqf()</code>
<a class="anchor" aria-label="anchor" href="#empirical-quantile-function-geom_eqf"></a>
</h3>
<p><code><a href="reference/geom_eqf.html">geom_eqf()</a></code> plots the empirical quantile function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>inf</mo><mo stretchy="false" form="prefix">{</mo><mi>x</mi><mo>:</mo><msub><mover><mi>F</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚â•</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">Q_n(p) = \inf\{x : \hat{F}_n(x) \ge p\}</annotation></semantics></math> as a left-continuous step function on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math>, using the same visual conventions as <code><a href="reference/geom_qf_discrete.html">geom_qf_discrete()</a></code>. The confidence ribbon inverts the KS ECDF band: at probability <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math> the band spans <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Q</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>‚àí</mo><mi>Œµ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>Q</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>+</mo><mi>Œµ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[Q_n(p - \varepsilon), Q_n(p + \varepsilon)]</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_single</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_eqf.html">geom_eqf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-eqf-1.png" width="60%"></p>
<p><strong>Multiple groups.</strong></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_two</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_eqf.html">geom_eqf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-eqf-grouped-1.png" width="60%"></p>
<p><strong>Informal normality test.</strong> Because the KS confidence band covers the true quantile function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(p)</annotation></semantics></math> with probability <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚â•</mo><mn>1</mn><mo>‚àí</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">\ge 1 - \alpha</annotation></semantics></math> regardless of the null, overlaying a parametric <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q_0(p)</annotation></semantics></math> turns the plot into a visual goodness-of-fit test: if <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mn>0</mn></msub><annotation encoding="application/x-tex">Q_0</annotation></semantics></math> lies entirely within the band the data are consistent with the hypothesized model; if it exits the band there is evidence against it. The comparison below fits a normal distribution by maximum likelihood (sample mean and SD) to two samples of size <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">n = 100</annotation></semantics></math>‚Äîone actually normal, one exponential‚Äîand overlays the fitted <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mn>0</mn></msub><annotation encoding="application/x-tex">Q_0</annotation></semantics></math> as a smooth line.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">df_gof</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  x      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Normal data"</span>, <span class="st">"Exponential data"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fitted normal QF for each sample</span></span>
<span><span class="va">normal_qf</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">p</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df_gof</span>, <span class="va">sample</span> <span class="op">==</span> <span class="st">"Normal data"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_eqf.html">geom_eqf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_qf.html">geom_qf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">normal_qf</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df_gof</span>, <span class="va">sample</span> <span class="op">==</span> <span class="st">"Normal data"</span><span class="op">)</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>,</span>
<span>          colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Normal data"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df_gof</span>, <span class="va">sample</span> <span class="op">==</span> <span class="st">"Exponential data"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_eqf.html">geom_eqf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_qf.html">geom_qf</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">normal_qf</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df_gof</span>, <span class="va">sample</span> <span class="op">==</span> <span class="st">"Exponential data"</span><span class="op">)</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>,</span>
<span>          colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Exponential data"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">p_norm</span> <span class="op">+</span> <span class="va">p_exp</span></span></code></pre></div>
<p><img src="reference/figures/readme-eqf-gof-1.png" width="60%"></p>
<p>The fitted normal line threads through the center of the band for the normal sample; for the exponential sample it departs visibly at the tails, where the asymmetry of the exponential distribution is most pronounced. Note that estimating parameters from the data makes the band slightly conservative (analogous to the Lilliefors correction), so this is an informal rather than exact test.</p>
</div>
<div class="section level3">
<h3 id="empirical-pmf-geom_epmf">Empirical PMF: <code>geom_epmf()</code>
<a class="anchor" aria-label="anchor" href="#empirical-pmf-geom_epmf"></a>
</h3>
<p><code><a href="reference/geom_epmf.html">geom_epmf()</a></code> tabulates the empirical probability mass function‚Äîplacing mass <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>k</mi></msub><mi>/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">c_k / n</annotation></semantics></math> at each distinct observed value <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>k</mi></msub><annotation encoding="application/x-tex">x_k</annotation></semantics></math>‚Äîand renders it as a lollipop chart using the same visual conventions as <code><a href="reference/geom_pmf.html">geom_pmf()</a></code>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_single</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_epmf.html">geom_epmf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-epmf-1.png" width="60%"></p>
<p><strong>Multiple groups.</strong></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_two</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_epmf.html">geom_epmf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/readme-epmf-grouped-1.png" width="60%"></p>
</div>
</div>
<div class="section level2">
<h2 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<ul>
<li>Browse the <a href="vignettes/ggfunction.Rmd">vignette</a> for a guided walkthrough</li>
<li>File bugs or feature requests at <a href="https://github.com/dusty-turner/ggfunction/issues" class="uri">https://github.com/dusty-turner/ggfunction/issues</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu">pak</span><span class="op">(</span><span class="st">"dusty-turner/ggfunction"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/dusty-turner/ggfunction/">Browse source code</a></li>
<li><a href="https://github.com/dusty-turner/ggfunction/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggfunction</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dusty Turner <br><small class="roles"> Author, maintainer </small>   </li>
<li>James Otto <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-0665-2515" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Rodney X. Sturdivant <br><small class="roles"> Author </small>   </li>
<li>David Kahle <br><small class="roles"> Author </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="License: MIT"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dusty Turner, James Otto, Rodney X. Sturdivant, David Kahle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
